# Maintainer:  danyf90 <daniele.formichelli@gmail.com>
# Contributor: Jeff Bigler <jbigler at saturnstudio dot com>

pkgname=trelby
pkgver=2.2
pkgrel=1
pkgdesc="A free, multiplatform, feature-rich screenwriting program"
arch=("any")
url="http://www.trelby.org"
license=('GPL')
depends=('wxpython' 'python2-lxml')
source=("http://www.trelby.org/files/release/$pkgver/$pkgname-$pkgver.tar.gz")
sha512sums=('ed0961282744fd10c8c19fe77b7cc485dda9570a9aed71bf18937db0bc832d92ed38a7744fc0d94c33c2cb1f1c3bf79bc8e5de45b3635c99e378a6baa9aa8a8d')

package() {
  cd $srcdir

  sed -i 's/env python/env python2'/ $srcdir/$pkgname-$pkgver/trelby/src/trelby.py
  sed -i "/^from error .*/a import wxversion\nwxversion.select('2.8')" $srcdir/$pkgname-$pkgver/trelby/src/trelby.py
  sed -i '/^Categories/c Categories=Office;Publishing' $srcdir/$pkgname-$pkgver/trelby/trelby.desktop

  install -d $pkgdir/opt
  cp -r $pkgname-$pkgver/trelby $pkgdir/opt
  install -Dm755 $pkgname-$pkgver/trelby/trelby.desktop $pkgdir/usr/share/applications/trelby.desktop
}
